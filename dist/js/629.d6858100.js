"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[629],{5629:function(e,i,a){a.r(i),a.d(i,{default:function(){return d}});var t=function(){var e=this,i=e._self._c;return i("div",[i("div",{staticClass:"mapBox"},[i("div",{staticClass:"searchBox"},[i("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入关键字","suffix-icon":"el-icon-search",size:"medium"},on:{input:e.searchByKeyword,focus:e.searchByKeyword},model:{value:e.keyword,callback:function(i){e.keyword=i},expression:"keyword"}}),e.searchResult.length&&e.isShowResult?i("div",{staticClass:"search-result"},e._l(e.searchResult,(function(a){return i("div",{key:a.id,staticClass:"result-item",on:{click:function(i){return e.handleClickResult(a)}}},[i("div",{staticClass:"area-name"},[e._v(e._s(a.name))]),i("div",{staticClass:"area-address"},[e._v(e._s(a.district+a.address))])])})),0):e._e()],1),i("div",{staticStyle:{width:"100%",height:"800px"},attrs:{id:"container"}}),i("div",{staticStyle:{"margin-top":"30px"}},[i("el-form",{attrs:{inline:!0,model:e.loc}},[i("el-form-item",{attrs:{label:"经度"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"经度"},model:{value:e.loc.longitude,callback:function(i){e.$set(e.loc,"longitude",i)},expression:"loc.longitude"}})],1),i("el-form-item",{attrs:{label:"纬度"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"纬度"},model:{value:e.loc.latitude,callback:function(i){e.$set(e.loc,"latitude",i)},expression:"loc.latitude"}})],1)],1)],1)])])},n=[],o=(a(7658),a(7634)),s=a.n(o);window._AMapSecurityConfig={securityJsCode:"ef9aaae77919a8015edd950af786c6b2"};var l={name:"",data(){return{dialogVisible:!1,map:null,loc:{longitude:"",latitude:""},marker:null,autocomplete:null,placeSearch:null,driving:null,keyword:"",searchResult:[],isShowResult:!1,clickPoints:[]}},mounted(){this.initMap()},methods:{initMap(){s().reset(),s().load({key:"aeef6b536679e762f2b6a59b56d98ae3",version:"2.0",plugins:["AMap.AutoComplete","AMap.PlaceSearch","AMap.MarkerClusterer","AMap.DistrictSearch","AMap.ZoomControl","AMap.Polygon","AMap.ToolBar","AMap.Driving"]}).then((e=>{this.map=new e.Map("container",{resizeEnable:!0,zoom:12,center:[114.304569,30.593354]}),this.map.on("click",(e=>{this.loc.latitude=e.lnglat.lat,this.loc.longitude=e.lnglat.lng,this.initMarket()}));var i={input:"tipinput"};this.autocomplete=new e.AutoComplete(i),this.placeSearch=new e.PlaceSearch({map:this.map}),this.driving=new e.Driving({map:this.map})})).catch((e=>{console.log(e)}))},handleClickResult(e){const{location:i,district:a,address:t}=e,{lng:n,lat:o}=i||{};n&&o?(this.map.clearMap(),this.changeValue(n,o,e.name,a+t)):(this.isShowResult=!1,this.placeSearch.search(a+t))},searchByKeyword(){this.autocomplete.search(this.keyword,((e,i)=>{"complete"===e&&"OK"===i.info&&(this.searchResult=i.tips.map((e=>({...e,address:Array.isArray(e.address)?e.address[0]||"":e.address}))),this.isShowResult=!0)}))},initMarket(e){if(this.loc.longitude&&this.loc.latitude){if(this.isShowResult=!1,this.map.getAllOverlays("marker").length&&this.map.clearMap(),this.marker=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:[this.loc.longitude,this.loc.latitude],offset:new AMap.Pixel(-10,-26),zIndex:102}),e){let i=4*e.length;marker.value.setLabel({offset:new AMap.value.Pixel(-i,35),content:e})}this.map.add(this.marker),this.clickPoints.length>=2?(this.clickPoints.shift(),this.clickPoints.push(this.marker)):(this.clickPoints.push(this.marker),this.driving.clear()),this.getDriving()}},getDriving(){if(console.log("=====",this.clickPoints),this.clickPoints.length>1){const e=new AMap.LngLat(this.clickPoints[0]._position[0],this.clickPoints[0]._position[1]),i=new AMap.LngLat(this.clickPoints[1]._position[0],this.clickPoints[1]._position[1]);this.driving.search(e,i,((e,i)=>{"complete"===e?console.log("驾驶路线规划成功:",i):console.error("驾驶路线规划失败:",i)}))}else this.driving.clear()},changeValue(e,i,a,t){this.isShowResult=!1,this.loc.longitude=e,this.loc.latitude=i;const n=new AMap.LngLat(e,i);this.map.setCenter(n),this.marker=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:[this.loc.longitude,this.loc.latitude],zIndex:103}),this.map.add(this.marker)}}},r=l,c=a(3736),p=(0,c.Z)(r,t,n,!1,null,"0076266b",null),d=p.exports},7634:function(e,i,a){a(7658),function(i,a){e.exports=a()}(0,(function(){function e(e){var t=[];return e.AMapUI&&t.push(i(e.AMapUI)),e.Loca&&t.push(a(e.Loca)),Promise.all(t)}function i(e){return new Promise((function(i,a){var l=[];if(e.plugins)for(var r=0;r<e.plugins.length;r+=1)-1==n.AMapUI.plugins.indexOf(e.plugins[r])&&l.push(e.plugins[r]);if(o.AMapUI===t.failed)a("前次请求 AMapUI 失败");else if(o.AMapUI===t.notload){o.AMapUI=t.loading,n.AMapUI.version=e.version||n.AMapUI.version,r=n.AMapUI.version;var c=document.body||document.head,p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/ui/"+r+"/main.js",p.onerror=function(e){o.AMapUI=t.failed,a("请求 AMapUI 失败")},p.onload=function(){if(o.AMapUI=t.loaded,l.length)window.AMapUI.loadUI(l,(function(){for(var e=0,a=l.length;e<a;e++){var t=l[e].split("/").slice(-1)[0];window.AMapUI[t]=arguments[e]}for(i();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()}));else for(i();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},c.appendChild(p)}else o.AMapUI===t.loaded?e.version&&e.version!==n.AMapUI.version?a("不允许多个版本 AMapUI 混用"):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,a=l.length;e<a;e++){var t=l[e].split("/").slice(-1)[0];window.AMapUI[t]=arguments[e]}i()})):i():e.version&&e.version!==n.AMapUI.version?a("不允许多个版本 AMapUI 混用"):s.AMapUI.push((function(e){e?a(e):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,a=l.length;e<a;e++){var t=l[e].split("/").slice(-1)[0];window.AMapUI[t]=arguments[e]}i()})):i()}))}))}function a(e){return new Promise((function(i,a){if(o.Loca===t.failed)a("前次请求 Loca 失败");else if(o.Loca===t.notload){o.Loca=t.loading,n.Loca.version=e.version||n.Loca.version;var l=n.Loca.version,r=n.AMap.version.startsWith("2"),c=l.startsWith("2");if(r&&!c||!r&&c)a("JSAPI 与 Loca 版本不对应！！");else{r=n.key,c=document.body||document.head;var p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/loca?v="+l+"&key="+r,p.onerror=function(e){o.Loca=t.failed,a("请求 AMapUI 失败")},p.onload=function(){for(o.Loca=t.loaded,i();s.Loca.length;)s.Loca.splice(0,1)[0]()},c.appendChild(p)}}else o.Loca===t.loaded?e.version&&e.version!==n.Loca.version?a("不允许多个版本 Loca 混用"):i():e.version&&e.version!==n.Loca.version?a("不允许多个版本 Loca 混用"):s.Loca.push((function(e){e?a(e):a()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var t;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(t||(t={}));var n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},o={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},s={AMap:[],AMapUI:[],Loca:[]},l=[],r=function(e){"function"==typeof e&&(o.AMap===t.loaded?e(window.AMap):l.push(e))};return{load:function(i){return new Promise((function(a,s){if(o.AMap==t.failed)s("");else if(o.AMap==t.notload){var c=i.key,p=i.version,d=i.plugins;c?(window.AMap&&"lbs.amap.com"!==location.host&&s("禁止多种API加载方式混用"),n.key=c,n.AMap.version=p||n.AMap.version,n.AMap.plugins=d||n.AMap.plugins,o.AMap=t.loading,p=document.body||document.head,window.___onAPILoaded=function(n){if(delete window.___onAPILoaded,n)o.AMap=t.failed,s(n);else for(o.AMap=t.loaded,e(i).then((function(){a(window.AMap)}))["catch"](s);l.length;)l.splice(0,1)[0]()},d=document.createElement("script"),d.type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+n.AMap.version+"&key="+c+"&plugin="+n.AMap.plugins.join(","),d.onerror=function(e){o.AMap=t.failed,s(e)},p.appendChild(d)):s("请填写key")}else if(o.AMap==t.loaded)if(i.key&&i.key!==n.key)s("多个不一致的 key");else if(i.version&&i.version!==n.AMap.version)s("不允许多个版本 JSAPI 混用");else{if(c=[],i.plugins)for(p=0;p<i.plugins.length;p+=1)-1==n.AMap.plugins.indexOf(i.plugins[p])&&c.push(i.plugins[p]);c.length?window.AMap.plugin(c,(function(){e(i).then((function(){a(window.AMap)}))["catch"](s)})):e(i).then((function(){a(window.AMap)}))["catch"](s)}else if(i.key&&i.key!==n.key)s("多个不一致的 key");else if(i.version&&i.version!==n.AMap.version)s("不允许多个版本 JSAPI 混用");else{var u=[];if(i.plugins)for(p=0;p<i.plugins.length;p+=1)-1==n.AMap.plugins.indexOf(i.plugins[p])&&u.push(i.plugins[p]);r((function(){u.length?window.AMap.plugin(u,(function(){e(i).then((function(){a(window.AMap)}))["catch"](s)})):e(i).then((function(){a(window.AMap)}))["catch"](s)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,n={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},o={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},s={AMap:[],AMapUI:[],Loca:[]}}}}))}}]);
//# sourceMappingURL=629.d6858100.js.map